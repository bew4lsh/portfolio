/* 
 * Theme-aware syntax highlighting styles
 * Integrates Shiki dual themes with our 5-theme color system
 */

/* Base syntax highlighting container */
.astro-code {
  background-color: var(--syntax-bg) !important;
  border: 1px solid var(--syntax-border);
  border-radius: 0.75rem;
  padding: 1rem;
  margin: 1.5rem 0;
  overflow-x: auto;
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', Consolas, monospace;
  font-size: 0.875rem;
  line-height: 1.6;
}

/* Default theme syntax variables (Portfolio Purple) */
:root {
  /* Syntax background and borders */
  --syntax-bg: var(--gray-900);
  --syntax-border: var(--gray-800);
  --syntax-selection: var(--accent-overlay);
  
  /* Core syntax token colors */
  --syntax-plain: var(--gray-200);
  --syntax-comment: var(--gray-400);
  --syntax-keyword: var(--accent-regular);
  --syntax-string: var(--chart-categorical-3);
  --syntax-function: var(--chart-categorical-1);
  --syntax-variable: var(--gray-100);
  --syntax-number: var(--chart-categorical-5);
  --syntax-operator: var(--gray-300);
  --syntax-punctuation: var(--gray-300);
  --syntax-tag: var(--accent-light);
  --syntax-attribute: var(--chart-categorical-2);
  --syntax-constant: var(--accent-dark);
  --syntax-type: var(--chart-categorical-4);
  --syntax-deleted: var(--chart-categorical-6);
  --syntax-inserted: var(--chart-categorical-3);
}

/* Dark mode syntax adjustments */
:root.theme-dark {
  --syntax-bg: var(--gray-800);
  --syntax-border: var(--gray-700);
  --syntax-plain: var(--gray-300);
  --syntax-comment: var(--gray-500);
  --syntax-variable: var(--gray-200);
  --syntax-operator: var(--gray-400);
  --syntax-punctuation: var(--gray-400);
}

/* Theme-specific syntax colors are now generated automatically in themes.css */

/* Override Shiki's default github-dark colors with our theme-aware colors */
/* Target specific color values that github-dark theme uses */

/* Comments - github-dark uses #6A737D */
.astro-code span[style*="#6A737D"] {
  color: var(--syntax-comment) !important;
  font-style: italic;
}

/* Keywords - github-dark uses #F97583 */
.astro-code span[style*="#F97583"] {
  color: var(--syntax-keyword) !important;
  font-weight: 600;
}

/* Strings - github-dark uses #9ECBFF */
.astro-code span[style*="#9ECBFF"] {
  color: var(--syntax-string) !important;
}

/* Numbers - github-dark uses #79B8FF */
.astro-code span[style*="#79B8FF"] {
  color: var(--syntax-number) !important;
}

/* Functions - github-dark uses #B392F0 */
.astro-code span[style*="#B392F0"] {
  color: var(--syntax-function) !important;
  font-weight: 500;
}

/* Plain text - github-dark uses #E1E4E8 */
.astro-code span[style*="#E1E4E8"] {
  color: var(--syntax-plain) !important;
}

/* Variables/identifiers - github-dark uses #FFAB70 */
.astro-code span[style*="#FFAB70"] {
  color: var(--syntax-variable) !important;
}

/* Types - github-dark uses #79B8FF (same as numbers, but we can differentiate) */
.astro-code span[style*="#79B8FF"]:not(:has(+ span[style*="("])) {
  color: var(--syntax-type) !important;
}

/* Constants - github-dark uses #79B8FF for constants too */
.astro-code .token.constant span[style*="#79B8FF"] {
  color: var(--syntax-constant) !important;
}

/* Tags - github-dark uses #85E89D */
.astro-code span[style*="#85E89D"] {
  color: var(--syntax-tag) !important;
}

/* Attributes - github-dark uses #FFAB70 */
.astro-code span[style*="#FFAB70"] {
  color: var(--syntax-attribute) !important;
}

/* Operators and punctuation - github-dark uses #F97583 for operators */
.astro-code span[style*="#F97583"]:is(.token.operator, .token.punctuation) {
  color: var(--syntax-operator) !important;
  font-weight: normal;
}

/* Line highlighting and selection */
.astro-code .line.highlighted {
  background-color: var(--syntax-selection);
  padding: 0 1rem;
  margin: 0 -1rem;
}

.astro-code::selection,
.astro-code *::selection {
  background-color: var(--syntax-selection);
}

/* Responsive adjustments */
@media (max-width: 50em) {
  .astro-code {
    font-size: 0.8rem;
    padding: 0.75rem;
    border-radius: 0.5rem;
    margin: 1rem 0;
    /* Prevent code blocks from causing horizontal overflow */
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: pre-wrap;
  }
  
  /* Ensure code lines wrap on mobile */
  .astro-code .line {
    word-wrap: break-word;
    overflow-wrap: break-word;
  }
}

/* Focus and accessibility */
.astro-code:focus-within {
  outline: 2px solid var(--accent-regular);
  outline-offset: 2px;
}

/* Smooth transitions for theme changes */
.astro-code,
.astro-code * {
  transition: color var(--theme-transition), background-color var(--theme-transition), border-color var(--theme-transition);
}